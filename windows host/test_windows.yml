---
  - name: Test Windows Tasks
    hosts: "{{ hostname }}"
    gather_facts: no
    become: yes

    tasks:
    - name: Unzip the file using PowerShell
      win_shell: |
        Expand-Archive -Path 'C:\Users\Administrator\Desktop\Installer\apache-tomcat-9.0.85.zip' -DestinationPath 'C:\Users\Administrator\Desktop\Installer' -Force
      args:
        executable: powershell.exe

    - name: Copy tomcat folder to designated path
      win_shell: |
        Copy-Item -Path C:\Users\Administrator\Desktop\Installer\apache-tomcat-9.0.85" -Destination "C:\Program Files\Apache Tomcat 9.0.85" -Recurse -Force
      args:
        executable: powershell.exe

    # - name: Copy tomcat folder to designated path
    #   win_copy:
    #     src: 'C:\Users\Administrator\Desktop\Installer\apache-tomcat-9.0.85'
    #     dest: 'C:\Program Files\Apache Tomcat 9.0.85'
    #     force: yes
    #     recurse: yes

      # - name: Extract Tomcat zip file
      #   win_unzip:
      #     src: C:\Users\Administrator\Desktop\Installer\apache-tomcat-9.0.85.zip
      #     dest: C:\Users\Administrator\Desktop\Installer
      #     remote_src: yes
